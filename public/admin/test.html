<!DOCTYPE html>
<html lang="zh-HK">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin - OHYA2.0</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #f5f5f5; }
    .sidebar { width: 220px; background: #1a1a2e; color: white; position: fixed; height: 100vh; padding: 20px; }
    .sidebar h2 { margin-bottom: 20px; color: #ec4899; }
    .nav-item { display: block; padding: 12px 15px; color: #aaa; text-decoration: none; border-radius: 8px; margin-bottom: 5px; }
    .nav-item:hover, .nav-item.active { background: #16213e; color: white; }
    .main { margin-left: 220px; padding: 20px; }
    .stat-card { background: white; padding: 20px; border-radius: 12px; margin-bottom: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .stat-value { font-size: 32px; font-weight: bold; }
    table { width: 100%; background: white; border-collapse: collapse; border-radius: 12px; overflow: hidden; }
    th, td { padding: 15px; text-align: left; border-bottom: 1px solid #eee; }
    th { background: #f8f9fa; }
  </style>
</head>
<body>
  <div class="sidebar">
    <h2>OHYA2.0 Admin</h2>
    <a href="#" class="nav-item active" onclick="nav('dashboard')">ğŸ“Š Dashboard</a>
    <a href="#" class="nav-item" onclick="nav('products')">ğŸ“¦ ç”¢å“ç®¡ç†</a>
    <a href="#" class="nav-item" onclick="nav('orders')">ğŸ›’ è¨‚å–®ç®¡ç†</a>
    <a href="#" class="nav-item" onclick="nav('customers')">ğŸ‘¥ å®¢æˆ¶ç®¡ç†</a>
    <a href="#" class="nav-item" onclick="nav('settings')">âš™ï¸ è¨­å®š</a>
  </div>
  <div class="main">
    <h1 id="title">Dashboard</h1>
    <div id="content"></div>
  </div>

  <script>
    // Simple test
    console.log('Script loaded!');
    
    let products = [];
    let orders = [];
    let customers = [];
    
    async function loadData() {
      console.log('Loading data...');
      try {
        const [pRes, oRes, cRes] = await Promise.all([
          fetch('/api/products'),
          fetch('/api/orders'),
          fetch('/api/customers')
        ]);
        products = await pRes.json();
        orders = await oRes.json();
        customers = await cRes.json();
        console.log('Data loaded!', products.length, orders.length, customers.length);
      } catch(e) {
        console.error('Error:', e);
      }
    }
    
    function nav(page) {
      console.log('nav called:', page);
      document.getElementById('title').innerText = page;
      
      if (page === 'dashboard') {
        document.getElementById('content').innerHTML = '
          <div class="stat-card"><div>ç¸½ç”¢å“</div><div class="stat-value" id="p-count">...</div></div>
          <div class="stat-card"><div>ç¸½è¨‚å–®</div><div class="stat-value" id="o-count">...</div></div>
          <div class="stat-card"><div>ç¸½å®¢æˆ¶</div><div class="stat-value" id="c-count">...</div></div>
        ';
        document.getElementById('p-count').innerText = products.length;
        document.getElementById('o-count').innerText = orders.length;
        document.getElementById('c-count').innerText = customers.length;
      } else if (page === 'products') {
        let html = '<h2>ç”¢å“åˆ—è¡¨ (' + products.length + 'ä»¶)</h2><table><thead><tr><th>ç·¨ç¢¼</th><th>åç¨±</th><th>åƒ¹æ ¼</th></tr></thead><tbody>';
        products.slice(0,20).forEach(p => {
          html += '<tr><td>' + (p.product_code||'') + '</td><td>' + (p.name||'').substring(0,30) + '</td><td>$' + (p.price||0) + '</td></tr>';
        });
        html += '</tbody></table>';
        document.getElementById('content').innerHTML = html;
      } else if (page === 'orders') {
        document.getElementById('content').innerHTML = '<p>è¨‚å–®: ' + orders.length + 'ä»¶</p>';
      } else if (page === 'customers') {
        document.getElementById('content').innerHTML = '<p>å®¢æˆ¶: ' + customers.length + 'äºº</p>';
      } else if (page === 'settings') {
        document.getElementById('content').innerHTML = '<p>è¨­å®šé é¢</p>';
      }
      
      // Update active
      document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
      event.target.classList.add('active');
    }
    
    // Init
    console.log('Calling loadData...');
    loadData().then(() => {
      console.log('Initial render...');
      nav('dashboard');
    });
  </script>
</body>
</html>
